#####################
# load libraries
# set wd
# clear global .envir
#####################
# remove objects
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
# here is where you load any necessary packages
# ex: stringr
# lapply(c("stringr"),  pkgTest)
lapply(c(),  pkgTest)
# set wd for current folder
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
#####################
# Problem 1
#####################
# load data
load(url("https://github.com/ASDS-TCD/StatsII_2026/blob/main/datasets/climateSupport.RData?raw=true"))
str(ClimateSupport)
str(climateSupport)
climateSupport$countries <- factor(climateSupport$countries)
climateSupport$sanctions <- factor(climateSupport$sanctions)
str(climateSupport)
## Fit model
additive_model <- glm(choice ~ countries + sanctions,
data = climateSupport,
family = binomial)
summary(additive_model)
## global null hypothesis
anova(additive_model, test = "Chisq")
## table
library(stargazer)
stargazer(additive_model,
type = "latex",
title = "Additive Logistic Regression Model",
label = "tab:additive_model",
dep.var.labels = "Support for Policy (1 = Yes)",
covariate.labels = c("Countries (Linear)",
"Countries (Quadratic)",
"Sanctions (Linear)",
"Sanctions (Quadratic)",
"Sanctions (Cubic)"),
digits = 3,
out = "additive_model.tex")
null_model <- glm(choice ~ 1, data = climateSupport, family = binomial)
anova(null_model, additive_model, test="Chisq")
# Example in R
library(ggplot2)
# Create new data for plotting
newdata <- expand.grid(
countries = factor(c(20, 80, 160)),  # all levels
sanctions = factor(c("None", "5%", "15%", "20%"))
)
# Predict probabilities
newdata$pred <- predict(additive_model, newdata, type="response")
# Create new data for plotting
newdata <- expand.grid(
countries = factor(c(20, 80, 160)),  # all levels
sanctions = factor(c("None", "5%", "15%", "20%"))
)
# Predict probabilities
newdata$pred <- predict(additive_model, newdata, type="response")
library(ggplot2)
# Create new data
newdata <- expand.grid(
countries = factor(c("20","80","160"), levels = levels(climateSupport$countries)),
sanctions = factor(c("None","5%","15%","20%"), levels = levels(climateSupport$sanctions))
)
# Predict probabilities
newdata$pred <- predict(additive_model, newdata, type = "response")
# Plot
ggplot(newdata, aes(x = sanctions, y = pred, color = countries, group = countries)) +
geom_point(size = 3) +
geom_line() +
ylab("Predicted Probability of Support") +
xlab("Sanctions Level") +
theme_minimal()
library(ggplot2)
# 1. Create new data using exact factor levels from original dataset
newdata <- expand.grid(
countries = levels(climateSupport$countries),
sanctions = levels(climateSupport$sanctions)
)
newdata$countries <- factor(newdata$countries, levels = levels(climateSupport$countries))
newdata$sanctions <- factor(newdata$sanctions, levels = levels(climateSupport$sanctions))
# 2. Predict probabilities using additive model
newdata$pred <- predict(additive_model, newdata = newdata, type = "response")
# 3. Plot predicted probabilities
ggplot(newdata, aes(x = sanctions, y = pred, color = countries, group = countries)) +
geom_point(size = 3) +
geom_line() +
ylab("Predicted Probability of Support") +
xlab("Sanctions Level") +
theme_minimal()
compare_160 <- data.frame(
countries = factor(c("160","160"), levels = levels(climateSupport$countries)),
sanctions = factor(c("5%", "15%"), levels = levels(climateSupport$sanctions))
)
logit_160 <- predict(additive_model, newdata = compare_160, type = "link")
odds_ratio_160 <- exp(logit_160[2] - logit_160[1])
# --------------------------------------------
# 2. Odds ratio: 20 countries, sanctions 5% -> 15%
# --------------------------------------------
compare_20 <- data.frame(
countries = factor(c("20","20"), levels = levels(climateSupport$countries)),
sanctions = factor(c("5%", "15%"), levels = levels(climateSupport$sanctions))
)
logit_20 <- predict(additive_model, newdata = compare_20, type = "link")
odds_ratio_20 <- exp(logit_20[2] - logit_20[1])
# --------------------------------------------
# 3. Estimated probability: 80 countries, no sanctions
# --------------------------------------------
prob_80_none <- predict(additive_model,
newdata = data.frame(
countries = factor("80", levels = levels(climateSupport$countries)),
sanctions = factor("None", levels = levels(climateSupport$sanctions))
),
type = "response")
# --------------------------------------------
# Print results
# --------------------------------------------
odds_ratio_160
odds_ratio_20
prob_80_none
View(climateSupport)
str(climateSupport)
# --------------------------------------------
# 1. Odds ratio: 160 countries, sanctions 5% -> 15%
# Use rows from original data
rows_160_5 <- climateSupport %>%
filter(countries == "160 of 192", sanctions == "5%")
#####################
# load libraries
# set wd
# clear global .envir
#####################
# remove objects
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
# here is where you load any necessary packages
# ex: stringr
# lapply(c("stringr"),  pkgTest)
lapply(c(),  pkgTest)
# set wd for current folder
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
#####################
# Problem 1
#####################
# load data
load(url("https://github.com/ASDS-TCD/StatsII_2026/blob/main/datasets/climateSupport.RData?raw=true"))
## Check structure
str(climateSupport) #all good
## Fit model
additive_model <- glm(choice ~ countries + sanctions,
data = climateSupport,
family = binomial)
summary(additive_model)
## Create table
library(stargazer)
stargazer(additive_model,
type = "latex",
title = "Additive Logistic Regression Model",
label = "tab:additive_model",
dep.var.labels = "Support for Policy (1 = Yes)",
covariate.labels = c("Countries (Linear)",
"Countries (Quadratic)",
"Sanctions (Linear)",
"Sanctions (Quadratic)",
"Sanctions (Cubic)"),
digits = 3,
out = "additive_model.tex")
## Fit null model for comparison
null_model <- glm(choice ~ 1, data = climateSupport, family = binomial)
anova(null_model, additive_model, test="Chisq")
# --------------------------------------------
# 1. Odds ratio: 160 countries, sanctions 5% -> 15%
# Use rows from original data
rows_160_5 <- climateSupport %>%
filter(countries == "160 of 192", sanctions == "5%")
library(dplyr)
# --------------------------------------------
# 1. Odds ratio: 160 countries, sanctions 5% -> 15%
# Use rows from original data
rows_160_5 <- climateSupport %>%
filter(countries == "160 of 192", sanctions == "5%")
rows_160_15 <- climateSupport %>%
filter(countries == "160 of 192", sanctions == "15%")
logit_160_5 <- predict(additive_model, newdata = rows_160_5, type="link")
logit_160_15 <- predict(additive_model, newdata = rows_160_15, type="link")
# Average logit for each group, then compute odds ratio
odds_ratio_160 <- exp(mean(logit_160_15) - mean(logit_160_5))
# --------------------------------------------
# 2. Odds ratio: 20 countries, sanctions 5% -> 15%
rows_20_5 <- climateSupport %>%
filter(countries == "20 of 192", sanctions == "5%")
rows_20_15 <- climateSupport %>%
filter(countries == "20 of 192", sanctions == "15%")
logit_20_5 <- predict(additive_model, newdata = rows_20_5, type="link")
logit_20_15 <- predict(additive_model, newdata = rows_20_15, type="link")
odds_ratio_20 <- exp(mean(logit_20_15) - mean(logit_20_5))
# --------------------------------------------
# 3. Estimated probability: 80 countries, no sanctions
rows_80_none <- climateSupport %>%
filter(countries == "80 of 192", sanctions == "None")
prob_80_none <- mean(predict(additive_model, newdata = rows_80_none, type="response"))
# --------------------------------------------
# 4. Print results
odds_ratio_160
odds_ratio_20
prob_80_none
library(dplyr)
# --------------------------------------------
# 1. Odds ratio: 160 countries, sanctions 5% -> 15%
# Use rows from original data
rows_160_5 <- climateSupport %>%
filter(countries == "160 of 192", sanctions == "5%")
rows_160_15 <- climateSupport %>%
filter(countries == "160 of 192", sanctions == "15%")
logit_160_5 <- predict(additive_model, newdata = rows_160_5, type="link")
logit_160_15 <- predict(additive_model, newdata = rows_160_15, type="link")
# Average logit for each group, then compute odds ratio
odds_ratio_160 <- exp(mean(logit_160_15) - mean(logit_160_5))
# --------------------------------------------
# 2. Odds ratio: 20 countries, sanctions 5% -> 15%
rows_20_5 <- climateSupport %>%
filter(countries == "20 of 192", sanctions == "5%")
rows_20_15 <- climateSupport %>%
filter(countries == "20 of 192", sanctions == "15%")
logit_20_5 <- predict(additive_model, newdata = rows_20_5, type="link")
logit_20_15 <- predict(additive_model, newdata = rows_20_15, type="link")
odds_ratio_20 <- exp(mean(logit_20_15) - mean(logit_20_5))
# --------------------------------------------
# 3. Estimated probability: 80 countries, no sanctions
rows_80_none <- climateSupport %>%
filter(countries == "80 of 192", sanctions == "None")
prob_80_none <- mean(predict(additive_model, newdata = rows_80_none, type="response"))
# --------------------------------------------
# 4. Print results
odds_ratio_160
odds_ratio_20
prob_80_none
View(newdata)
## Interaction Effect
interaction_model <- glm(choice ~ countries * sanctions,
data = climateSupport,
family = binomial)
anova(additive_model, interaction_model, test = "Chisq")
